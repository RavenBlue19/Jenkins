pipeline {
    agent any
    environment {
        DIRECTORY_PATH = "/SIT223/Jenkins"
        TESTING_ENVIRONMENT = "SIT223"
        PRODUCTION_ENVIRONMENT = "Sam"
    }
    stages {
        stage('build') {
            steps {
                echo " compiling and packaging using Maven"
            }
        }
        stage('test') {
            steps {
                echo "Running tests"
                echo "Tests Completed"
            }
            post {
                success {
                    emailext (
                    to: "safifi19@gmail.com",
                    subject: "test",
                    body: "test completed",
                    attachmentsPattern: "log.txt",
                    mimeType: 'text/plain'
                    )
                }
            }
        }
        stage('code quality check') {
            steps {
                echo "Using SonarQube Scanner to check code quality"
                echo "Quality standard is met"
            }
        }
        stage('security scan') {
            steps {
                echo "Scaning for vulnerabilities"
            }
            post {
                success {
                    emailext (
                    to: "safifi19@gmail.com",
                    subject: "security",
                    body: "security scan completed",
                    attachmentsPattern: "log.txt",
                    mimeType: 'text/plain'
                    )
                }
            }
        }
        stage('deploy to staging') {
            steps {
                 echo "deploying to staging server"
            }
        }
        stage('Integration tests on staging') {
            steps {
                echo "running integration tests on staging"
            }
        }   
        stage('Deploy to production'){
            steps {
                echo "deploying to production using AWS EC2 Instance"
            }
        }
    }
}
